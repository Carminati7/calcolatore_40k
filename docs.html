<!DOCTYPE html>
<html lang="it">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Documentazione Calcolatore 40k</title>
    <link rel="stylesheet" href="assets/style.css">
</head>
<body>
    <header>
        <nav class="main-nav">
            <a href="index.html">Calcolatore</a>
            <a href="docs.html" class="active">Documentazione</a>
        </nav>
        <h1>Documentazione</h1>
    </header>
    <main>
        <section class="doc-section">
            <h2>Come usare il calcolatore</h2>
            <p>Compila i dati della tua unità e del bersaglio, poi premi "Calcola" per ottenere una stima dei danni e dei modelli eliminati.<br>
            <strong>Campo Danni:</strong> puoi inserire un valore singolo (es. 2), un intervallo (es. 1-3), una lista (es. 1,2,3), la notazione Dn (es. D3), oppure una formula (es. D6+2, 2+D3, D3+1). Il calcolatore userà il valore medio risultante della formula inserita.<br>
            <strong>Opzioni Reroll:</strong> puoi abilitare una sola delle due opzioni:
            <ul>
                <li><strong>Permetti reroll di tutti i tiri falliti:</strong> tutti i tiri falliti vengono rilanciati, aumentando la probabilità di colpire.</li>
                <li><strong>Permetti reroll dei risultati 1:</strong> solo i risultati di 1 vengono rilanciati. Le due opzioni sono mutualmente esclusive.</li>
            </ul>
            </p>
        </section>
        <section class="doc-section">
            <h2>Formule utilizzate</h2>
            <ul>
                <li><strong>Danni attesi:</strong> attacchi × probabilità di colpire × probabilità di ferire × probabilità di non salvezza × <strong>danno medio</strong> (calcolato dal campo Danni)</li>
                <li><strong>Modelli eliminati:</strong> la stima tiene conto che più attacchi a segno possono sommarsi per eliminare un modello con più ferite (no overkill: i danni in eccesso non si trasferiscono al modello successivo). Formula: danni attesi / ferite per modello</li>
                <li><strong>Probabilità di eliminare tutti i modelli:</strong> stimata tramite distribuzione di Poisson sui danni attesi totali rispetto alle ferite totali dell'unità bersaglio</li>
            </ul>
        </section>
        <section class="doc-section">
            <h2>PWA: risoluzione problemi e reinstallazione</h2>
            <p>Se hai installato l'app come PWA e noti che apre una pagina errata (es. l'app parte da <code>/</code> invece che da <code>/calcolatore_40k/</code>), probabilmente il manifest o il service worker vecchio è ancora in cache. Segui questi passi:</p>
            <ol>
                <li>Disinstalla l'app PWA dal desktop (rimuovi il collegamento/installazione).</li>
                <li>Apri la pagina GitHub Pages: <code>https://carminati7.github.io/calcolatore_40k/</code>.</li>
                <li>Apri DevTools (F12) → Scheda <strong>Application</strong>:
                    <ul>
                        <li>Service Workers: clicca <em>Unregister</em> per il service worker del sito.</li>
                        <li>Storage / Clear site data: usa <em>Clear site data</em> per rimuovere cache e manifest memorizzati.</li>
                        <li>Manifest: verifica che <code>start_url</code> sia <code>/calcolatore_40k/index.html</code> e <code>scope</code> sia <code>/calcolatore_40k/</code>.</li>
                    </ul>
                </li>
                <li>Ricarica la pagina e reinstalla la PWA (usa l'icona <em>Install</em> nella barra degli indirizzi o il menu del browser → Install app).</li>
                <li>Apri l'app dal desktop/collegamento ed esegui un controllo veloce: DevTools → Application (dentro la finestra dell'app installata) e conferma che <code>start_url</code> e <code>scope</code> sono corretti.</li>
            </ol>
            <p>Se dopo questi passi l'app continua ad aprirsi nella path errata, inviami il browser e la versione (es. Chrome 123 su Windows 11) e uno screenshot della scheda <strong>Application</strong> — controllerò il manifest e la registrazione del service worker.</p>
        </section>
    </main>
</body>
</html>
